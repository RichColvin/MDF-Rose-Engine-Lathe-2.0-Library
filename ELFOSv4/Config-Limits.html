<!DOCTYPE html>
<meta name="viewport" content="width=device-width, initial-scale=1">
<html>

<head bgcolor=#E6E6E6>
<title>ELFOS</title>
<link rel="shortcut icon" type="image/ico" href="favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="Images/favicon.png">

<body style="background-color: #E6E6E6; font: 16px Arial; ">

<!-- ################################################### -->
<!-- Code for Including Standard HTML files on the 	 -->
<!-- server					         -->
<!-- ################################################### -->
<script src="library.js"></script>

<script>
function includeHTML() {
  var z, i, elmnt, file, xhttp;
  /* Loop through a collection of all HTML elements: */
  z = document.getElementsByTagName("*");
  for (i = 0; i < z.length; i++) {
    elmnt = z[i];
    /*search for elements with a certain atrribute:*/
    file = elmnt.getAttribute("w3-include-html");
    if (file) {
      /* Make an HTTP request using the attribute value as the file name: */
      xhttp = new XMLHttpRequest();
      xhttp.onreadystatechange = function() {
        if (this.readyState == 4) {
          if (this.status == 200) {elmnt.innerHTML = this.responseText;}
          if (this.status == 404) {elmnt.innerHTML = "Page not found.";}
          /* Remove the attribute, and call this function once more: */
          elmnt.removeAttribute("w3-include-html");
          includeHTML();
        }
      }
      xhttp.open("GET", file, true);
      xhttp.send();
      /* Exit the function: */
      return;
    }
  }
}
</script> 

<!-- ################################################### -->
<!-- Site Standards Include File        		  		 -->
<div w3-include-html="include-SiteStandards.html"></div> 
<script>
includeHTML();
</script>

<!-- ################################################### -->
<!-- Body - Right Side of the Screen                     -->
<!-- ################################################### -->

<body bgcolor=#E6E6E6 background="Images/DevBackground.png">

<div style="float: right;
        margin-top: 0px; margin-bottom: 5px;
        margin-left: 10px; margin-right: 0px; 
        padding-top: 0px; padding-bottom: 0px;
        padding-left: 0px; padding-right: 0px; 
        border: 0px solid black; 
        text-align: left;  
        background-color:#E6E6E6; 
        " >
    <img src="Images/Screens/Limits.jpg" width="450px" class="Image" alt="HTML Map" border="0" usemap="#html">
    <map name = "html">
        <area shape = "rect" coords = "002,002,075,033" href = "Config-Spindle.html" />
        <area shape = "rect" coords = "002,038,075,069" href = "Config-ZAxis.html" />
        <area shape = "rect" coords = "002,075,075,107" href = "Config-XAxis.html" />
        <area shape = "rect" coords = "002,111,075,143" href = "Config-M3.html" />
        <area shape = "rect" coords = "002,147,075,180" href = "Config-M4.html" />
            
        <area shape = "rect" coords = "376,038,450,070" href = "Config-Limits.html" />
        <area shape = "rect" coords = "376,074,450,106" href = "Config-Returns.html" />
        <area shape = "rect" coords = "376,112,450,143" href = "Config-More.html" />                     
        <area shape = "rect" coords = "376,217,450,252" href = "Config-More-LoadIni.html" />                     

        <area shape = "rect" coords = "375,001,446,033" href = "javascript:history.back()" />
    </map>
</div>

<!-- ################################################### -->
<!-- Body - Left Side of the Screen                      -->
<!-- ################################################### -->

<table align="Center" border="0">
    <tr height="35px">
        <td align="Center" bgcolor="#3980C0" width="300px">
            <font color="White" size="4"><b>Preferences Screen</b></font>
    	</td>
    </tr>
</table>

<div style="float: right; width: 200px; margin: 5px 5px 5px 5px; padding: 5px; border: 1px solid black; text-align: left; background-color:#3980C0">
    <font color="White" size="2">Touch the buttons on the screen image to the right to see the details for the that screen.</font>
</div>

<!-- ################################################### -->
<!-- Purpose  -->
<b>Purpose:</b> Set (Teensy) pin numbers to be used for limit switches.

<p>The use of a specific pin for Min or Max for any given axis is not critical.  However, using the same pin # for Min and Max is not recommended.  The reason is that, if the limit is tripped for one direction, movement in that direction is halted.  However, movement in the other direction is not.  Note though that tripping the Stop limit will halt movement in all directions.
            
<p>The Teensy microcontroller allows for pins 18, 19, and 25 - 39 to be used.  These need to match the ones wired to your board.

<p>Recommendation:

<table align="center" border=1>
    <col width="75px">
    <col width="350px">
    
    <tr align="center" valign="bottom" bgcolor="moccasin">
        <th>
            Teensy
            <br>
            Pin
        </th>
        <th>
            Purpose
        </th>
    </tr>
    <tr>
        <td align="center">
            18 or 19
        </td>
        <td>
            Stop
        </td>
    </tr>
    <tr>
        <td align="center">
            25 - 39
        </td>
        <td>
            Limit switches; lower numbers for &quot;Min&quot; and higher numbers for &quot;Max&quot;.
        </td>
    </tr>
<table>

<p><font color="red">Limit switches can be used for all screens except <a href="Ind.html" target="_self" >Index</a> and <a href="Grk.html" target="_self" >Greek Key</a></font>.
            
<hr class="style1">

    <ul>
        <li style="margin-bottom: 12px;">The values shown in a <span style="background-color: #FFEE9C">&nbsp;tan box&nbsp;</span> show values on the Nextion.  Touching one of the text boxes allows you to edit that value using the <a href="NumberPad.html">Number Pad</a> screen.</li>

        <li>The values shown in a <span style="background-color: LightGray">&nbsp;gray box&nbsp;</span>  show the ones stored on the Teensy controller.  These are read only and should match the settings on the Nextion.</li>
    </ul>

<hr class="style1">

<table style="margin-top: 12px;">
    <col width="70px">
    <col width="70px">
    <col width="*">
                    
    <tr valign="top">
        <td rowspan=4>
            <table bgcolor="#F6DA17">
                <tr>
                    <td>
                        &nbsp; <b>Min</b> &nbsp;
                    </td>
                </tr>
            </table>
        </td>
        
        <td>
            <b>Z axis</b>
        </td>
        
        <td>
            <div style="float: right; margin: 0px 0px 0px 0px; border: 0px solid Darkgray; text-align: left; ">
                <img src="Images/Buttons/ButtonMain-In.png" width="45px">
            </div>
            
            The <b>Min</b> pin on this axis is used when moving in the direction towards the headstock
        </td>
    </tr>

    <tr valign="top">
        <td>
            <b>X axis</b>
        </td>
        
        <td>
            <div style="float: right; margin: 0px 0px 0px 0px; border: 0px solid Darkgray; text-align: left; ">
                <img src="Images/Buttons/ButtonMain-In.png" width="45px">
            </div>

            The <b>Min</b> pin on this axis is used when moving in the direction towards the spindle's axis
        </td>
    </tr>
    
    <tr valign="top">
        <td>
            <b>M3 axis</b>
        </td>
        
        <td>
            <div style="float: right; margin: 0px 0px 0px 5px; border: 0px solid Darkgray; text-align: left; ">
                <img src="Images/Buttons/ButtonMain-In.png" width="45px">
            </div>
            
            <p style="margin-top: 0;">The <b>Min</b> pin on this axis is used when moving in the direction towards the spindle's axis
            
            <div style="float: right; margin: 0px 0px 0px 5px; border: 0px solid Darkgray; text-align: left; ">
                <img src="Images/Buttons/ButtonMain-CW.png" width="45px">
            </div>
            
            <p style="margin-bottom: 0;">In theory, it can also be used when M3 is configured for radial usage, but that seems difficult to grasp.
        </td>
    </tr>
    
    <tr valign="top">
        <td>
            <b>M4 axis</b>
        </td>
        
        <td>
            <div style="float: right; margin: 0px 0px 0px 5px; border: 0px solid Darkgray; text-align: left; ">
                <img src="Images/Buttons/ButtonMain-In.png" width="45px">
            </div>
            
            <p style="margin-top: 0;">The <b>Min</b> pin on this axis is used when moving in the direction towards the spindle's axis
            
            <div style="float: right; margin: 0px 0px 0px 5px; border: 0px solid Darkgray; text-align: left; ">
                <img src="Images/Buttons/ButtonMain-CW.png" width="45px">
            </div>
            
            <p style="margin-bottom: 0;">In theory, it can also be used when M4 is configured for radial usage, but that seems difficult to grasp.    
        </td>
    </tr>
    
    <tr>
        <td>
            &nbsp;
        </td>
    </tr>

    <tr valign="top">
        <td rowspan=4>
            <table bgcolor="#F6DA17">
                <tr>
                    <td>
                        &nbsp; <b>Max</b> &nbsp;
                    </td>
                </tr>
            </table>
        </td>
        
        <td>
            <b>Z axis</b>
        </td>
        
        <td>
            <div style="float: right; margin: 0px 0px 0px 5px; border: 0px solid Darkgray; text-align: left; ">
                <img src="Images/Buttons/ButtonMain-Out.png" width="45px">
            </div>
            
            The <b>Max</b> pin on this axis is used when moving in the direction away from the headstock.
        </td>
    </tr>
    
    <tr valign="top">
        <td>
            <b>X axis</b>
        </td>
        
        <td>
            <div style="float: right; margin: 0px 0px 0px 5px; border: 0px solid Darkgray; text-align: left; ">
                <img src="Images/Buttons/ButtonMain-Out.png" width="45px">
            </div>
            
            The <b>Max</b> pin on this axis is used when moving in the direction away from the spindle's axis
        </td>
    </tr>
    
    <tr valign="top">
        <td>
            <b>M3 axis</b>
        </td>
        
        <td>
            <div style="float: right; margin: 0px 0px 0px 5px; border: 0px solid Darkgray; text-align: left; ">
                <img src="Images/Buttons/ButtonMain-Out.png" width="45px">
            </div>
            
            <p style="margin-top: 0;">The <b>Max</b> pin on this axis is used when moving in the direction away from the spindle's axis
            
            <div style="float: right; margin: 0px 0px 0px 5px; border: 0px solid Darkgray; text-align: left; ">
                <img src="Images/Buttons/ButtonMain-CCW.png" width="45px">
            </div>
            
            <p style="margin-bottom: 0;">In theory, it can also be used when M3 is configured for radial usage, but that seems difficult to grasp.
        </td>
    </tr>
    
    <tr valign="top">
        <td>
            <b>M4 axis</b>
        </td>
        
        <td>
            <div style="float: right; margin: 0px 0px 0px 5px; border: 0px solid Darkgray; text-align: left; ">
                <img src="Images/Buttons/ButtonMain-Out.png" width="45px">
            </div>
            
            <p style="margin-top: 0;">The <b>Max</b> pin on this axis is used when moving in the direction away from the spindle's axis
            
            <div style="float: right; margin: 0px 0px 0px 5px; border: 0px solid Darkgray; text-align: left; ">
                <img src="Images/Buttons/ButtonMain-CW.png" width="45px">
            </div>
            
            <p style="margin-bottom: 0;">In theory, it can also be used when M4 is configured for radial usage, but that seems difficult to grasp.
        </td>
    </tr>
</table>

<p>If the limit switch is engaged when using any function, the action button for that direction's limit switch will turn red. No further action can be taken until the Stop button is touched.
    
<div style="width: 50%; margin: auto; 
        border: 0px solid Darkgray; text-align: center; ">
    <img  src="Images/Screens/Sync4.png" width = "100%">
    <br>
    <b>Max Limit Switch Triggered on Sync Screen</b>
</div>

<div style="width: 50%; margin: auto; 
        border: 0px solid Darkgray; text-align: center; ">
    <img  src="Images/Screens/Sync5.png" width = "100%">
    <br>
    <b>Min Limit Switch Triggered on Sync Screen</b>
</div>

<p><div style="float: right; width: 40px; 1px 1px 1px 1px; padding: 1px; border: 0px solid black; text-align: center; background-color:#White">
    <img  src="Images/Buttons/ButtonEStop-Stop.jpg" width="100%">
</div>

<p>To reset, touch the stop button.  Once that is done, the opposite direction action button can be touched even though the limit switch may still be triggered.

<hr class="style1">

<div style="float: right; width: 200px; margin: 5px 5px 5px 5px; padding: 5px; border: 0px solid Darkgray; text-align: left; ">
    <img src="Images/BigRedSwitch.png" width="100%">
</div>

<div style="float: left; width: 75px; margin: 0px 0px 0px 0px; padding: 5px; border: 0px solid Darkgray; text-align: left; ">
    <table bgcolor="#F6DA17" align="left">
        <tr>
            <td>
                &nbsp; <b>eStop</b> &nbsp;
            </td>
        </tr>
    </table>
</div>

designates the pin number used to immediately stop all movement on the stepper motors.  
        
<p>This is different from the limit function which performs a slow, controlled stop.  The Stop is typically implemented as a big red switch like to the right.

<div style="float: right; width: 300px; margin: 5px 5px 5px 5px; border: 0px solid Darkgray; text-align: left; ">
    <table border="1" bgcolor="moccasin" width="100%">
        <tr>
            <td style="padding: 5px;">
                <p style="margin-top: 0; margin-top: 0;"><b>Wiring multiple Stop switches?</b>
                
                <p style="margin-top: 0; margin-bottom: 0;"><a href="Config-LimitSwitches.html">These are the directions for wiring them</a>.
            </td>
        </tr>
    </table>
</div>

<font color="red">
<p><b><u>Key Notes</u>:</b>
    <ol>
        <li style="margin-bottom: 12px;">This function is not a <a href="https://en.wikipedia.org/wiki/Kill_switch" target="_new">kill switch</a>.  When triggered, this function does not de-energize the lathe by disconnecting the power in-feed.  It simply stops all movement driven by the stepper motors.</li>
        
        <li>Also, this function does not stop the overhead drive so the cutter will still be operating as it was before this was engaged.</li>
    </ol>
</font>
        
<p>If the Stop is engaged when using any function, all the movement buttons will turn red.
    
<p style="margin-bottom: 0;">
<center>
    <img  src="Images/Screens/Main5.png" width = "50%">
    <br>
    <b>Stop on Main Screen</b>
</center>

    <p>
    <center>
        <img  src="Images/Screens/Sync6.png" width = "50%">
        <br>
        <b>Stop on Sync Screen</b>
    </center>

<p>To reset:
<div style="float: right; width: 40px; 1px 1px 1px 1px; padding: 1px; border: 0px solid black; text-align: center; background-color:#White">
    <img  src="Images/Buttons/ButtonEStop-Stop.jpg" width="100%">
</div>
                
    <ol>
        <li>Ensure the Stop switch is not closed, and</li>
        <li>Touch one of the stop buttons.</li>
    </ol>
            
<!-- ################################################### -->
<!-- Controls   -->

<table width="100%">
    <col width="225px">
    <col width="*">

    <tr>
        <td colspan=999>
            <hr class="style1">
        </td>
    </tr>
    
    <tr valign="top">
        <td>
            <img src="Images/SquareChecked.png" width="20px" height="20px">
            <b>Stop Spindle with Axis</b>
        </td>
        <td>
            <p style="margin-top: 0;">This option determines what happens when the limit is triggered.

            <p><img src="Images/SquareChecked.png" width="20px" height="20px"> = Stop motion on both the axis (i.e., Z, X, or B) and the spindle when the limit is triggered.

            <p style="margin-bottom: 0;"><img src="Images/SquareUnChecked.png" width="20px" height="20px"> = Stop motion on the axis only when the limit is triggered (the spindle remains turning).
        </td>
    </tr>
</table>

<hr class="style1">

<table width="100%">
    <col width="150px">
    <col width="*">
    
    <tr valign="top">
        <td>
            <table bgcolor="#F6DA17" align="left">
                <tr>
                    <td>
                        &nbsp; <b>Type</b> &nbsp;
                    </td>
                </tr>
            </table>
        </td>
        
        <td>
            <p style="margin-top: 0;">This option tells the system which type of switch is being used.
            
            <p><img src="Images/CircleChecked.png" width="20px" height="20px"> <b>NC</b> = normally closed (NC) / momentary open switch
            
            <p style="margin-bottom: 0;"><img src="Images/CircleUnChecked.png" width="20px" height="20px"> <b>NO</b> = normally open (NO) / momentary close switch
        </td>
    </tr>
</table>

<hr class="style2">
                
<!-- ################################################### -->
<!-- Release Notes  -->
<b>How It Works</b>

<p style="margin-top: 0;">When the limit is triggered, the system stops.

<div style="float: right; width: 50px; 5px 5px 5px 5px; padding: 5px; border: 0px solid black; text-align: center;  background-color:#E6E6E6; background-image: url(Images/DevBackground.png);">
    <img  src="Images/Buttons/ButtonMain-Stop.png" width="100%">
</div>

<p>To reset after a stop, touch the stop button (shown to the right).  You will have to do this for both the spindle and the axis in use.

<p style="margin-bottom: 0;">The system is setup this way to prevent damage to the machinery if it left unattended for a while, but also to allow the artist to get to the next operation quicker.

<!-- ################################################### -->
<!-- Physical Stuff  -->

<hr class="style2">

<p><div style="float: right; width: 150px; 5px 5px 5px 5px; padding: 5px; border: 1px solid black; text-align: center;  background-color:#E6E6E6; background-image: url(Images/DevBackground.png);">
    <img  src="Images/3.5mm Plug.png" width="100%">
    <br>
    <b>3.5 mm Plug</b>
</div>

The 3.5 mm (<sup>1</sup>/<sub>8</sub>&quot;) jack used on the MDF Rose Engine Lathe 2.0 has the plug's tip connected to the respective pin on the Teensy, and the sleeve is connected to ground.  Shorting across these two will cause the limit condition to trigger.
            
<p>Using the sleeve for the ground is key for many reasons, and that is the design outlined in <i>&quot;Instructions for Building the Stepper Controls&quot;</i>.
            
<div style="float: right; width: 150px; 5px 5px 5px 5px; padding: 5px; border: 1px solid black; text-align: center;  background-color:#E6E6E6; background-image: url(Images/DevBackground.png);">
    <img  src="Images/LimitSwitch.png" width="100%">
    <br>
    <b>Limit Switch</b>
</div>
            
With the MDF Rose Engine Lathe 2.0, we have tested using the Miniature Snap-Acting Switch with a Lever Actuator, from <a href="https://www.mcmaster.com/">McMaster-Carr</a>, p/n <a href="https://www.mcmaster.com/7779K13/" >7779K13</a>. 

<p>This can be attached to a magnetic base stand, especially one with a <a href="https://www.otbok.info/OT%20-%20LnT-Term-NogaArm.html" >Noga arm</a>, to position it where needed.  We have a <a href="3DPrint-LimSw.html" target="_self">mounting bracket</a> which can be 3D printed to attach this switch to the Noga arm. 

<!-- ################################################### -->
<!-- Using  -->

<hr class="style1">

<p><b>Diagnostics:</b> If you are experiencing issues using limit switches, below are some diagnostic steps I've found useful.

<p><b>Limit Switches don't stop spindle movement</b>

    <p class="indented">Ensure the option on this screen, "Stop Spindle with Axis",  is enabled.
    
    <p class="indented"><u>Recommended Action</u>:  Unless you need to not stop the spindle, leave this option checked as the default for how you use your machine.

<p><b>Limit Switches don't stop axis movement</b>
            
    <p class="indented">Ensure you have connected you limit switch to the pin configured for the respective axis.

    <p class="indented"><u>Recommended Action</u>:  If you are only going to use one limit switch, set all of these to 34, and connect your limit switch to that pin.
                        
    <p class="indented">If you are going to use two limit switches, set all the Mins to 34 and all the Maxes to 35.

<p><b>Stepper Motors won't run on Main or One Screens</b>

    <p class="indented">One or more limit switches may be "engaged".  This can happen if they are not wired correctly or there is a short in the limit switch wiring. 

    <p class="indented">You can confirm that this is or is not the case by trying to drive the stepper motor motion from the screens which don't use limit switches.
                        
    <p class="indented"><u>Recommended Action</u>:  Read the instructions regarding limit switch connections in <i>&quot;Instructions for Building the Stepper Controls&quot;</i>.
</div>

<!-- ################################################### -->
<!-- Footer                                              -->
<!-- ################################################### -->
<div w3-include-html="include-Footer.html"></div> 
<script>
includeHTML();
</script> 
</body>
</html>
